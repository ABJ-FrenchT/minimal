#!/bin/sh
. /usr/local/sbin/colours.sh

clear;
PURPLE;
echo "\nPentest mit Openvas.\n";
NC;
BLUE;
echo "Haben Sie eine Internetverbindung \nund wollen Sie die neuesten Tests nachladen? j|n \n"
NC;
read n
case $n in
	j|J)
		CYAN;
		echo "Aktualisiere openvas Plugins.\n\n";
		NC;
		sudo /usr/sbin/openvas-nvt-sync;
	;;
	*)
	GREEN;
	echo "\nFahre ohne Aktualisierung der Tests fort.\n"
	NC;
	;;
esac

CYAN;
echo "\nStarte openvas Server. \nDas kann einige Zeit dauern. \nBitte warten Sie.\n"
NC;
sudo /etc/init.d/openvas-server start

BLUE;
echo "\nWelchen Host wollen Sie scannen (Bsp. 192.168.100.1)\n"
NC;
read i

echo $i > /tmp/scanhost

CYAN;
echo "\nStarte Scan von $i.\n"
NC;
GREEN;
echo "\nNach dem Scan wird das Ergebnis in einem\ntextbasierten Browser angezeigt.\nDer Browser kann durch druecken von q beendet werden.\n"
NC;
/usr/bin/OpenVAS-Client -q localhost 9390 pentest pentest /tmp/scanhost /tmp/scan.html -T html

w3m /tmp/scan.html 

BLUE;
echo "\nWollen Sie einen anderen Host testen? j|n\n"
NC;
read n;

case $n in
	j|J)
		$0;
	;;
	n|N)
		BLUE;
		echo "\nPC herunterfahren? j|n\n";
		NC;
		read s
		case $s in
			j|J)
				CYAN;
				echo "\nFahre PC herunter.\n";
				NC;
				sudo init 0;
			;;
			n|N)
				exit 0;
			;;
			*)
				CYAN;
				echo "\nIch habe Sie nicht verstanden.\ Beende pentst.\n"
				NC;
			;;
		esac
esac

